<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Letterfall - Tecnotips</title>
    <!-- Vinculaci√≥n del Manifiesto para PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5">
    
    <style>
        :root {
            --primary-bg: #6366f1;
            --accent-warm: #f43f5e;
            --accent-sunny: #fbbf24;
            --cyan-glow: #22d3ee;
            --glass-white: rgba(255, 255, 255, 0.9);
            --text-dark: #1e293b;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 40%, #db2777 100%);
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            color: var(--text-dark);
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            pointer-events: none;
            animation: float-bubbles 20s infinite linear;
        }

        @keyframes float-bubbles {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-20vh) scale(1.5); opacity: 0; }
        }

        .container {
            background: var(--glass-white);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 420px;
            padding: 1.5rem;
            padding-top: 3.5rem;
            border-radius: 30px; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            text-align: center;
            position: relative;
            border: 4px solid rgba(255, 255, 255, 0.3);
        }

        .header-top-row {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-pill {
            background: var(--text-dark);
            padding: 4px 12px;
            border-radius: 20px;
            color: white;
            font-size: 0.65rem;
            font-weight: 900;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        h1 {
            font-size: 3rem;
            margin: 15px 0 5px 0;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: -2px;
        }

        .hint-container {
            width: 100%;
            margin: 10px 0;
            padding: 10px;
            background: #fef3c7;
            border-radius: 15px;
            border: 2px dashed #f59e0b;
            display: none;
        }

        .hint-text { color: #b45309; font-weight: 700; font-size: 0.85rem; }

        .stats-wrapper {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 15px;
            gap: 10px;
        }

        .stat-bubble {
            flex: 1;
            background: white;
            padding: 8px;
            border-radius: 18px;
            font-weight: 800;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        .observer-btn {
            background: #22c55e;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 18px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 4px 0 #166534;
        }

        .cat-btn {
            width: 100%;
            padding: 16px;
            margin: 6px 0;
            border: none;
            border-radius: 20px;
            background: #4f46e5;
            color: white;
            font-weight: 800;
            font-size: 1.1rem;
            box-shadow: 0 6px 0 #3730a3;
            cursor: pointer;
        }
        .cat-btn:nth-child(even) { background: #ec4899; box-shadow: 0 6px 0 #9d174d; }

        #hangman-canvas {
            background: #f8fafc;
            border-radius: 20px;
            margin: 10px 0;
            border: 3px solid #e2e8f0;
            width: 100%;
            height: auto;
        }

        .word-box {
            font-size: 2.2rem;
            letter-spacing: 5px;
            margin: 15px 0;
            font-weight: 900;
            color: #334155;
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            width: 100%;
        }

        .key {
            padding: 10px 0;
            border: none;
            background: white;
            border-radius: 10px;
            font-weight: 800;
            box-shadow: 0 4px 0 #cbd5e1;
            cursor: pointer;
        }
        .key.correct { background: #4ade80; color: white; box-shadow: 0 4px 0 #166534; }
        .key.wrong { background: #f87171; color: white; box-shadow: 0 4px 0 #991b1b; }

        .footer-row {
            margin-top: 25px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.05);
            font-size: 0.65rem;
            font-weight: 800;
            color: #94a3b8;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .overlay {
            position: fixed; inset: 0; background: rgba(79, 70, 229, 0.4);
            display: none; justify-content: center; align-items: center; z-index: 2000;
            backdrop-filter: blur(8px);
        }
        .modal { 
            background: white; padding: 30px; border-radius: 30px; 
            width: 85%; max-width: 320px; text-align: center; 
            border: 6px solid #4f46e5;
        }
        
        .screen { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        #confetti-layer {
            position: fixed; inset: 0; pointer-events: none; z-index: 3000;
        }
    </style>
</head>
<body>

<div id="bubbles-bg"></div>
<canvas id="confetti-layer"></canvas>

<div class="container">
    <div class="header-top-row">
        <div class="top-pill">GAMERS FM</div>
        <div class="top-pill" style="background: var(--accent-warm);">CHECHO</div>
    </div>

    <h1>LETTERFALL</h1>

    <div id="hint-box" class="hint-container">
        <span id="hint-text" class="hint-text"></span>
    </div>

    <div id="screen-start" class="screen active">
        <p style="font-weight: 800; color: #64748b; margin: 10px 0 15px 0;">¬°ELIGE UN TEMA!</p>
        <div id="cat-list" style="width: 100%;"></div>
    </div>

    <div id="screen-game" class="screen">
        <div class="stats-wrapper">
            <div class="stat-bubble">‚ù§Ô∏è <span id="lives">6</span></div>
            <button id="observer-btn" class="observer-btn" onclick="useObserver()">
                üëÅÔ∏è <span id="tips-count">2</span>
            </button>
            <div class="stat-bubble" style="background: #fffbeb;">üí∞ <span id="reward">0</span></div>
        </div>
        
        <canvas id="hangman-canvas" width="200" height="160"></canvas>
        <div id="word-display" class="word-box"></div>
        <div id="kb" class="keyboard"></div>
        <button class="cat-btn" style="background:#fbbf24; color:#92400e; box-shadow:0 4px 0 #d97706; margin-top:15px" onclick="solve()">¬øSABES LA PALABRA?</button>
    </div>

    <div class="footer-row">
        <span>TECNOTIPS ¬© 2026</span>
        <span>V1.1</span>
    </div>
</div>

<div id="overlay" class="overlay">
    <div class="modal" id="modal-box"></div>
</div>

<script>
    const data = {
    "Frutas": [
        "MANZANA", "PERA", "PLATANO", "SANDIA", "MANGO", 
        "KIWI", "CEREZA", "DURAZNO", "UVA", "FRUTILLA", 
        "PI√ëA", "PAPAYA", "GRANADA", "HIGO", "MEL√ìN"
    ],
    "Cine": [
        "AVATAR", "TITANIC", "SHREK", "BATMAN", "ALIEN", 
        "GLADIADOR", "DUNA", "SUPERMAN", "JOKER", "SPIDERMAN", 
        "INCEPTION", "MATRIX", "INTERSTELLAR", "FROZEN", "TOY STORY"
    ],
    "Tecno": [
        "IPHONE", "GOOGLE", "PYTHON", "LAPTOP", "TABLET", 
        "ROBOT", "REDMI", "MOTOROLA", "SAMSUNG", "LINUX", 
        "WINDOWS", "INTEL", "AMD", "XIAOMI", "HUAWEI"
    ],
    "Deportes": [
        "FUTBOL", "TENIS", "BOXEO", "BASQUET", "RUGBY", 
        "GOLF", "KARATE", "NATACI√ìN", "CICLISMO", "ATLETISMO", 
        "SURF", "ESGRIMA", "VOLEIBOL", "HOCKEY", "TAEKWONDO"
    ],
    "Animales": [
        "ELEFANTE", "TIGRE", "JIRAFA", "DELFIN", "AGUILA", 
        "CEBRA", "CULEBRA", "CABALLO", "MUERCIELAGO", "OSO", 
        "LE√ìN", "PANDA", "LOBO", "CANGURO", "PING√úINO"
    ]
    };

    const hints = {
        "Frutas": "Deliciosa y natural",
        "Cine": "Magia en la pantalla",
        "Tecno": "Gadgets e innovaci√≥n",
        "Deportes": "Acci√≥n y competencia",
        "Animales": "Criaturas del mundo"
    };

    let state = { lives: 6, reward: 0, word: "", guesses: [], mistakes: 0, tips: 2, correctStreak: 0 };
    const cvs = document.getElementById('hangman-canvas');
    const ctx = cvs.getContext('2d');
    
    // Configuraci√≥n Confeti
    const confCanvas = document.getElementById('confetti-layer');
    const confCtx = confCanvas.getContext('2d');
    let confetti = [];

    function createBubbles() {
        const container = document.getElementById('bubbles-bg');
        for (let i = 0; i < 15; i++) {
            const b = document.createElement('div');
            b.className = 'bubble';
            const size = Math.random() * 60 + 20;
            b.style.width = size + 'px';
            b.style.height = size + 'px';
            b.style.left = Math.random() * 100 + 'vw';
            b.style.animationDelay = Math.random() * 5 + 's';
            b.style.animationDuration = Math.random() * 10 + 10 + 's';
            container.appendChild(b);
        }
    }

    function init() {
        createBubbles();
        const list = document.getElementById('cat-list');
        list.innerHTML = "";
        Object.keys(data).forEach(c => {
            const b = document.createElement('button');
            b.className = 'cat-btn';
            b.innerText = c;
            b.onclick = () => start(c);
            list.appendChild(b);
        });
        window.addEventListener('resize', resizeConfetti);
        resizeConfetti();
    }

    function resizeConfetti() {
        confCanvas.width = window.innerWidth;
        confCanvas.height = window.innerHeight;
    }

    function start(c) {
        state.word = data[c][Math.floor(Math.random()*data[c].length)];
        state.guesses = []; state.mistakes = 0; state.lives = 6; state.correctStreak = 0;
        document.getElementById('hint-text').innerText = hints[c];
        document.getElementById('hint-box').style.display = 'block';
        document.getElementById('screen-start').classList.remove('active');
        document.getElementById('screen-game').classList.add('active');
        document.getElementById('lives').innerText = state.lives;
        document.getElementById('tips-count').innerText = state.tips;
        drawBase(); renderKb(); update();
    }

    function drawBase() {
        ctx.clearRect(0,0,200,160);
        ctx.strokeStyle = "#cbd5e1"; ctx.lineWidth = 8; ctx.lineCap = "round";
        ctx.beginPath();
        ctx.moveTo(40, 140); ctx.lineTo(160, 140);
        ctx.moveTo(70, 140); ctx.lineTo(70, 20);
        ctx.lineTo(130, 20); ctx.lineTo(130, 40);
        ctx.stroke();
    }

    function drawPart(m) {
        ctx.strokeStyle = "#4f46e5"; ctx.lineWidth = 5;
        switch(m) {
            case 1: ctx.beginPath(); ctx.arc(130, 55, 12, 0, Math.PI*2); ctx.stroke(); break;
            case 2: ctx.beginPath(); ctx.moveTo(130, 67); ctx.lineTo(130, 105); ctx.stroke(); break;
            case 3: ctx.beginPath(); ctx.moveTo(130, 75); ctx.lineTo(110, 95); ctx.stroke(); break;
            case 4: ctx.beginPath(); ctx.moveTo(130, 75); ctx.lineTo(150, 95); ctx.stroke(); break;
            case 5: ctx.beginPath(); ctx.moveTo(130, 105); ctx.lineTo(115, 130); ctx.stroke(); break;
            case 6: ctx.beginPath(); ctx.moveTo(130, 105); ctx.lineTo(145, 130); ctx.stroke(); break;
        }
    }

    function renderKb() {
        const box = document.getElementById('kb');
        box.innerHTML = "";
        "ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ".split("").forEach(l => {
            const b = document.createElement('button');
            b.className = 'key'; b.innerText = l;
            b.id = `key-${l}`;
            b.onclick = () => guess(l, b);
            box.appendChild(b);
        });
    }

    function guess(l, btn) {
        if (btn.disabled) return;
        btn.disabled = true;
        if (state.word.includes(l)) {
            state.guesses.push(l);
            btn.classList.add('correct');
            state.correctStreak++;
            if(state.correctStreak >= 3) {
                state.tips++; state.correctStreak = 0;
                document.getElementById('tips-count').innerText = state.tips;
            }
        } else {
            state.mistakes++; state.lives--; state.correctStreak = 0;
            btn.classList.add('wrong');
            drawPart(state.mistakes);
            document.getElementById('lives').innerText = state.lives;
            if (state.mistakes >= 6) end(false);
        }
        update();
    }

    function useObserver() {
        if (state.tips <= 0) return;
        const missing = state.word.split("").filter(l => !state.guesses.includes(l));
        if (missing.length > 0) {
            state.tips--;
            document.getElementById('tips-count').innerText = state.tips;
            const randomLetter = missing[Math.floor(Math.random() * missing.length)];
            guess(randomLetter, document.getElementById(`key-${randomLetter}`));
        }
    }

    function update() {
        const d = state.word.split("").map(l => state.guesses.includes(l) ? l : "_").join("");
        document.getElementById('word-display').innerText = d;
        if (!d.includes("_") && state.word !== "") end(true);
    }

    function solve() {
        const val = prompt("¬øYa lo sabes? Escribe la palabra:");
        if (val && val.toUpperCase() === state.word) {
            state.guesses = state.word.split(""); update();
        } else if (val) { 
            state.mistakes++; state.lives--; drawPart(state.mistakes);
            document.getElementById('lives').innerText = state.lives;
            if(state.mistakes >= 6) end(false); 
        }
    }

    function startConfetti() {
        confetti = [];
        for (let i = 0; i < 100; i++) {
            confetti.push({
                x: Math.random() * confCanvas.width,
                y: -10,
                r: Math.random() * 6 + 4,
                d: Math.random() * 10 + 10,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                tilt: Math.random() * 10 - 5
            });
        }
        requestAnimationFrame(updateConfetti);
    }

    function updateConfetti() {
        confCtx.clearRect(0, 0, confCanvas.width, confCanvas.height);
        let active = false;
        confetti.forEach(p => {
            p.y += p.d * 0.2;
            p.x += Math.sin(p.y * 0.05);
            if (p.y < confCanvas.height) {
                active = true;
                confCtx.beginPath();
                confCtx.lineWidth = p.r;
                confCtx.strokeStyle = p.color;
                confCtx.moveTo(p.x + p.tilt + p.r / 2, p.y);
                confCtx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 2);
                confCtx.stroke();
            }
        });
        if (active) requestAnimationFrame(updateConfetti);
    }

    function playApplause() {
        if (!window.AudioContext) return;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const duration = 2;
        const bufferSize = audioCtx.sampleRate * duration;
        const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
            data[i] = (Math.random() * 2 - 1) * 0.1;
        }
        const noise = audioCtx.createBufferSource();
        noise.buffer = buffer;
        const gain = audioCtx.createGain();
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        noise.connect(gain);
        gain.connect(audioCtx.destination);
        noise.start();
    }

    function end(win) {
        if (win) {
            startConfetti();
            playApplause();
            state.reward += 100;
            document.getElementById('reward').innerText = state.reward;
            
            setTimeout(() => {
                const over = document.getElementById('overlay');
                const box = document.getElementById('modal-box');
                over.style.display = 'flex';
                box.innerHTML = `<h2 style="color:#10b981">¬°FANT√ÅSTICO!</h2><p>¬°Palabra acertada!</p><div style="font-size:2rem">üéÅ +$100</div><button class="cat-btn" style="margin-top:15px" onclick="reset()">OTRA PARTIDA</button>`;
            }, 3000);
        } else {
            const over = document.getElementById('overlay');
            const box = document.getElementById('modal-box');
            over.style.display = 'flex';
            box.innerHTML = `<h2 style="color:#ef4444">¬°OH NO!</h2><p>Era: <b style="color:#4f46e5">${state.word}</b></p><button class="cat-btn" style="margin-top:15px; background:#ef4444" onclick="reset()">REINTENTAR</button>`;
            document.getElementById('reward').innerText = state.reward;
        }
    }

    function reset() {
        confCtx.clearRect(0,0,confCanvas.width, confCanvas.height);
        confetti = [];
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('hint-box').style.display = 'none';
        document.getElementById('screen-game').classList.remove('active');
        document.getElementById('screen-start').classList.add('active');
    }

    window.onload = init;
</script>
</body>
</html>
